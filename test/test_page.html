<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Geolocation Javascript API</title>
  <script type="text/javascript" src="../ext/loki.js"></script>
  <script type="text/javascript" src="../ext/gears_init.js"></script>
  <script type="text/javascript" src="../src/locus.js"></script>  
  <script type="text/javascript">
    function listServices() {
      var list = '';

      var services = ['loki','w3c','gears'];

      for (var i = 0; i < services.length; i++) {
        if (locus.check(services[i])) {
          list += '<li>' + services[i] + '</li>';
        }
      }

      if (list.length == 0) {
        list = '<li>None.</li>';
      }

      document.getElementById('service-list').innerHTML = list;
    }
    
    function load() {
      var defaultClick = function() {
        locus.getCurrentPosition(function(location) {
          document.getElementById('default-latlng').innerHTML = "lat = " + location.latitude 
            + ", lng = " + location.longitude;
        }, function(message) {
          document.getElementById('default-latlng').innerHTML = message;
        });
      };
      
      document.getElementById('default').addEventListener('click', defaultClick, false);
      
      var lokiClick = function() {
        locus.getCurrentPosition(function(location) {
          document.getElementById('loki-latlng').innerHTML = "lat = " + location.latitude 
            + ", lng = " + location.longitude;
        }, function(message) {
          document.getElementById('loki-latlng').innerHTML = message;
        }, {serviceList: ['loki'], LOKI_KEY: 'larrymyers.com'});
      };
      
      document.getElementById('loki').addEventListener('click', lokiClick, false);
      
      var w3cClick = function() {
        locus.getCurrentPosition(function(location) {
          document.getElementById('w3c-latlng').innerHTML = "lat = " + location.latitude 
            + ", lng = " + location.longitude;
        }, function(message) {
          document.getElementById('w3c-latlng').innerHTML = message;
        }, {serviceList: ['w3c']});
      };
      
      document.getElementById('w3c').addEventListener('click', w3cClick, false);
      
      var gearsClick = function() {
        locus.getCurrentPosition(function(location) {
          document.getElementById('gears-latlng').innerHTML = "lat = " + location.latitude 
            + ", lng = " + location.longitude;
        }, function(message) {
          document.getElementById('gears-latlng').innerHTML = message;
        }, {serviceList: ['gears']});
      };
      
      document.getElementById('gears').addEventListener('click', gearsClick, false);
      
      listServices();
    }
  </script>
</head>
<body onload="load();">
  <h1>Simple Geolocation Javascript API Example</h1>
  
  <h2>Installed:</h2>
  
  <ul id="service-list"></ul>
  
  <h2>Default</h2>
  
  <p id="default-latlng"></p>
  
  <button id="default">Get Location</button>
  
  <h2>Loki</h2>
  
  <p id="loki-latlng"></p>
  
  <button id="loki">Get Location</button>
  
  <h2>W3C Geolocation</h2>
  
  <p id="w3c-latlng"></p>
  
  <button id="w3c">Get Location</button>
  
  <h2>Google Gears</h2>
  
  <p id="gears-latlng"></p>
  
  <button id="gears">Get Location</button>
</body>
</html>